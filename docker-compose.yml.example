services:
  pihole-dns-sync:
    image: ghcr.io/dangerzau/pihole-dns-sync:latest
    container_name: pihole-dns-sync
    environment:
      - STATE_FILE=${STATE:-/data/pihole_state.json}        # optional, pick location
      - RECONCILE_INTERVAL_MINUTES=${RECONCILE_INTERVAL_MINUTES:-5}
      - DEBUG=${DEUG:-false}
      - DEFAULT_DNS_TARGET=${DEFAULT_DNS_TARGET:-Default.target.net}
      - PIHOLE_URL=${PIHOLE_URL:-http://addressofpiholeinstance/api/}
      - PIHOLE_PASSWORD=${PIHOLE_PASSWORD:-}  # read from .env or env var, default empty
      - TRAEFIK_WATCH=${TRAEFIK_WATCH:-true}
      - SCAN_ON_START=${SCAN_ON_START:-true} # perform a full scan immediately after startup (in addition to periodic runs)
      - WAIT_FOR=${WAIT_FOR:-traefik,pihole}          # wait for Traefik and Pi-hole
      - WAIT_TIMEOUT_SECONDS=${WAIT_TIMEOUT_SECONDS:-60}          # timeout after a minute
      # Global DNS mappings (mapping1 through mapping99)
      # Format: mapping<N>=sourceaddress,destinationaddress
      # If destinationaddress is an IP, creates an A record; otherwise creates a CNAME record
      - mapping1=${MAPPING1:-alwaysmapthis.domain.net,target.domain.net}
      - mapping2=${MAPPING2:-}  # add more mappings as needed, or leave empty
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock:ro  # To interact with Docker API
      - ./data:/data 
    restart: unless-stopped

